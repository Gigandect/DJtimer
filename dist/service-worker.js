const CACHE_NAME="DJ-timer-cache-v1.0.2",urlsToCache=["/DJtimer/","/DJtimer/index.html","/DJtimer/manifest.webmanifest","/DJtimer/service-worker.js","/DJtimer/icons/icon-192x192.png","/DJtimer/icons/icon-512x512.png","/DJtimer/icons/icon-maskable-192x192.png","/DJtimer/icons/icon-maskable-512x512.png","https://fonts.googleapis.com/css2?family=Montserrat:wght@900&display=swap"];self.addEventListener("install",(e=>{console.log("[Service Worker] Installing..."),e.waitUntil(caches.open(CACHE_NAME).then((e=>(console.log("[Service Worker] Caching app shell"),e.addAll(urlsToCache)))).catch((e=>{console.error("[Service Worker] Cache addAll failed:",e)}))),self.skipWaiting()})),self.addEventListener("activate",(e=>{console.log("[Service Worker] Activating..."),e.waitUntil(caches.keys().then((e=>Promise.all(e.map((e=>{if(e!==CACHE_NAME)return console.log("[Service Worker] Deleting old cache:",e),caches.delete(e)}))))).then((()=>self.clients.claim())))})),self.addEventListener("fetch",(e=>{const t="font"===e.request.destination||/\.(woff|woff2|ttf|otf|eot|css)(\?.*)?$/.test(e.request.url)&&e.request.url.includes("fonts.googleapis.com");"navigate"!==e.request.mode?t?e.respondWith(caches.match(e.request).then((t=>t?(console.log("[Service Worker] Serving font-related asset from cache:",e.request.url),t):(console.log("[Service Worker] Fetching font-related asset from network:",e.request.url),fetch(e.request).then((t=>{if(t&&t.ok){const r=t.clone();caches.open(CACHE_NAME).then((t=>{t.put(e.request,r)}))}return t})).catch((t=>{throw console.error("[Service Worker] Font-related asset fetch failed:",e.request.url,t),t})))))):e.respondWith(caches.match(e.request).then((t=>t?(console.log("[Service Worker] Serving from cache:",e.request.url),t):(console.log("[Service Worker] Fetching from network:",e.request.url),fetch(e.request).then((t=>{if(t&&200===t.status&&"basic"===t.type){const r=t.clone();caches.open(CACHE_NAME).then((t=>{t.put(e.request,r)}))}return t}))))).catch((t=>{console.error("[Service Worker] Fetch failed and no cache match for:",e.request.url,t)}))):e.respondWith(fetch(e.request).catch((()=>caches.match("/DJtimer/index.html"))))}));